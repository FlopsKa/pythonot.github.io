

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1D Wasserstein barycenter comparison between exact LP and entropic regularization &mdash; POT Python Optimal Transport 0.7.0b documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plot graphs’ barycenter using FGW" href="plot_barycenter_fgw.html" />
    <link rel="prev" title="OT for multi-source target shift" href="plot_otda_jcpot.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> POT Python Optimal Transport
          

          
          </a>

          
            
            
              <div class="version">
                0.7.0b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">POT: Python Optimal Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../all.html">Python modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">POT Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_OT_1D.html">1D optimal transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_UOT_1D.html">1D Unbalanced optimal transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_screenkhorn_1D.html">1D Screened optimal transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_optim_OTreg.html">Regularized OT with generic solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_OT_1D_smooth.html">1D smooth optimal transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_free_support_barycenter.html">2D free support Wasserstein barycenters of distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_compute_emd.html">Plot multiple EMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_gromov.html">Gromov-Wasserstein example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_convolutional_barycenter.html">Convolutional Wasserstein Barycenter example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_linear_mapping.html">Linear OT mapping estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_OT_2D_samples.html">2D Optimal transport between empirical distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_WDA.html">Wasserstein Discriminant Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_stochastic.html">Stochastic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_color_images.html">OT for image color adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_barycenter_1D.html">1D Wasserstein barycenter demo</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_laplacian.html">OT with Laplacian regularization for domain adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_mapping_colors_images.html">OT for image color adaptation with mapping estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_UOT_barycenter_1D.html">1D Wasserstein barycenter demo for Unbalanced distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_mapping.html">OT mapping estimation for domain adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_fgw.html">Plot Fused-gromov-Wasserstein</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_semi_supervised.html">OTDA unsupervised vs semi-supervised setting</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_classes.html">OT for domain adaptation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_partial_wass_and_gromov.html">Partial Wasserstein and Gromov-Wasserstein example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_d2.html">OT for domain adaptation on empirical distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_OT_L1_vs_L2.html">2D Optimal transport for different metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_otda_jcpot.html">OT for multi-source target shift</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">1D Wasserstein barycenter comparison between exact LP and entropic regularization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gaussian-data">Gaussian Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stair-data">Stair Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dirac-data">Dirac Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#final-figure">Final figure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_barycenter_fgw.html">Plot graphs’ barycenter using FGW</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_gromov_barycenter.html">Gromov-Wasserstein Barycenter example</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">POT Python Optimal Transport</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">POT Examples</a> &raquo;</li>
        
      <li>1D Wasserstein barycenter comparison between exact LP and entropic regularization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/auto_examples/plot_barycenter_lp_vs_entropic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-barycenter-lp-vs-entropic-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="d-wasserstein-barycenter-comparison-between-exact-lp-and-entropic-regularization">
<span id="sphx-glr-auto-examples-plot-barycenter-lp-vs-entropic-py"></span><h1>1D Wasserstein barycenter comparison between exact LP and entropic regularization<a class="headerlink" href="#d-wasserstein-barycenter-comparison-between-exact-lp-and-entropic-regularization" title="Permalink to this headline">¶</a></h1>
<p>This example illustrates the computation of regularized Wasserstein Barycenter
as proposed in [3] and exact LP barycenters using standard LP solver.</p>
<p>It reproduces approximately Figure 3.1 and 3.2 from the following paper:
Cuturi, M., &amp; Peyré, G. (2016). A smoothed dual approach for variational
Wasserstein problems. SIAM Journal on Imaging Sciences, 9(1), 320-343.</p>
<p>[3] Benamou, J. D., Carlier, G., Cuturi, M., Nenna, L., &amp; Peyré, G. (2015).
Iterative Bregman projections for regularized transportation problems
SIAM Journal on Scientific Computing, 37(2), A1111-A1138.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Remi Flamary &lt;remi.flamary@unice.fr&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: MIT License</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">ot</span>
<span class="c1"># necessary for 3d plot even if not used</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">PolyCollection</span>  <span class="c1"># noqa</span>

<span class="c1">#import ot.lp.cvx as cvx</span>
</pre></div>
</div>
<div class="section" id="gaussian-data">
<h2>Gaussian Data<a class="headerlink" href="#gaussian-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problems</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># nb bins</span>

<span class="c1"># bin positions</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="c1"># Gaussian distributions</span>
<span class="c1"># Gaussian distributions</span>
<span class="n">a1</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">make_1D_gauss</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># m= mean, s= std</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">make_1D_gauss</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># creating matrix A containing all distributions</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">n_distributions</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># loss matrix + normalization</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">dist0</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">M</span> <span class="o">/=</span> <span class="n">M</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_distributions</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distributions&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_001.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 0&lt;=alpha&lt;=1</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">alpha</span><span class="p">])</span>

<span class="c1"># l2bary</span>
<span class="n">bary_l2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="c1"># wasserstein</span>
<span class="n">reg</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">ot</span><span class="o">.</span><span class="n">tic</span><span class="p">()</span>
<span class="n">bary_wass</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">bregman</span><span class="o">.</span><span class="n">barycenter</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>


<span class="n">ot</span><span class="o">.</span><span class="n">tic</span><span class="p">()</span>
<span class="n">bary_wass2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">lp</span><span class="o">.</span><span class="n">barycenter</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;interior-point&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>

<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_distributions</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distributions&#39;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_l2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reg Wasserstein&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LP Wasserstein&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Barycenters&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">problems</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="n">bary_l2</span><span class="p">,</span> <span class="n">bary_wass</span><span class="p">,</span> <span class="n">bary_wass2</span><span class="p">]])</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_002.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Elapsed time : 0.0049059391021728516 s
Primal Feasibility  Dual Feasibility    Duality Gap         Step             Path Parameter      Objective
1.0                 1.0                 1.0                 -                1.0                 1700.336700337
0.006776453137632   0.006776453137632   0.006776453137632   0.9932238647293  0.006776453137632   125.6700527543
0.004018712867873   0.004018712867873   0.004018712867873   0.4301142633001  0.004018712867873   12.26594150092
0.001172775061627   0.001172775061627   0.001172775061627   0.7599932455027  0.001172775061627   0.3378536968898
0.0004375137005386  0.0004375137005386  0.0004375137005386  0.6422331807989  0.0004375137005386  0.1468420566359
0.0002326690467339  0.0002326690467339  0.0002326690467339  0.5016999460898  0.0002326690467339  0.09381703231428
7.430121674299e-05  7.4301216743e-05    7.430121674299e-05  0.7035962305811  7.430121674299e-05  0.05777870257169
5.321227838943e-05  5.321227838945e-05  5.321227838944e-05  0.3087841864307  5.321227838944e-05  0.05266249477219
1.990900379216e-05  1.99090037922e-05   1.990900379216e-05  0.6520472013271  1.990900379216e-05  0.04526054405523
6.305442046834e-06  6.305442046856e-06  6.305442046837e-06  0.7073953304085  6.305442046837e-06  0.04237597591384
2.290148391591e-06  2.290148391631e-06  2.290148391602e-06  0.6941812711476  2.29014839161e-06   0.04152284932101
1.182864875578e-06  1.182864875548e-06  1.182864875555e-06  0.5084552046229  1.182864875567e-06  0.04129461872829
3.626786386894e-07  3.626786386985e-07  3.626786386845e-07  0.7101651569095  3.626786385995e-07  0.0411303244893
1.539754244475e-07  1.539754247164e-07  1.539754247197e-07  0.6279322077522  1.539754251915e-07  0.04108867636377
5.193221608537e-08  5.19322169648e-08   5.193221696942e-08  0.6843453280956  5.193221892276e-08  0.04106859618454
1.888205219929e-08  1.88820500654e-08   1.888205006369e-08  0.6673443828803  1.888205852187e-08  0.04106214175236
5.676837529301e-09  5.676842740457e-09  5.676842761502e-09  0.7281712198286  5.676877044229e-09  0.04105958648535
3.501170987746e-09  3.501167688027e-09  3.501167721804e-09  0.4140142115019  3.501183058995e-09  0.04105916265728
1.110582426269e-09  1.110580273241e-09  1.110580239523e-09  0.6999003212726  1.110624310022e-09  0.04105870073273
5.768753963318e-10  5.769422203363e-10  5.769421938248e-10  0.5002521235315  5.767522037401e-10  0.04105859764872
1.534102102874e-10  1.535920569433e-10  1.535921107494e-10  0.7516900610544  1.535251083958e-10  0.04105851678411
6.717475002202e-11  6.735435784522e-11  6.735430717133e-11  0.5944268235824  6.732253215483e-11  0.04105850033323
1.751321118837e-11  1.74043080851e-11   1.740429001123e-11  0.7566075167358  1.736956306927e-11  0.0410584908946
Optimization terminated successfully.
         Current function value: 0.041058
         Iterations: 22
Elapsed time : 2.149055242538452 s
</pre></div>
</div>
</div>
<div class="section" id="stair-data">
<h2>Stair Data<a class="headerlink" href="#stair-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">a2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">)</span>

<span class="n">a1</span> <span class="o">/=</span> <span class="n">a1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">a2</span> <span class="o">/=</span> <span class="n">a2</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># creating matrix A containing all distributions</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">n_distributions</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># loss matrix + normalization</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">dist0</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">M</span> <span class="o">/=</span> <span class="n">M</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_distributions</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distributions&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_003.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_003.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 0&lt;=alpha&lt;=1</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">alpha</span><span class="p">])</span>

<span class="c1"># l2bary</span>
<span class="n">bary_l2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="c1"># wasserstein</span>
<span class="n">reg</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">ot</span><span class="o">.</span><span class="n">tic</span><span class="p">()</span>
<span class="n">bary_wass</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">bregman</span><span class="o">.</span><span class="n">barycenter</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>


<span class="n">ot</span><span class="o">.</span><span class="n">tic</span><span class="p">()</span>
<span class="n">bary_wass2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">lp</span><span class="o">.</span><span class="n">barycenter</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;interior-point&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>


<span class="n">problems</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="n">bary_l2</span><span class="p">,</span> <span class="n">bary_wass</span><span class="p">,</span> <span class="n">bary_wass2</span><span class="p">]])</span>

<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_distributions</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distributions&#39;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_l2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reg Wasserstein&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LP Wasserstein&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Barycenters&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_004.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Elapsed time : 0.008316993713378906 s
Primal Feasibility  Dual Feasibility    Duality Gap         Step             Path Parameter      Objective
1.0                 1.0                 1.0                 -                1.0                 1700.336700337
0.006776466288938   0.006776466288938   0.006776466288938   0.9932238515788  0.006776466288938   125.66492558
0.004036918865472   0.004036918865472   0.004036918865472   0.4272973099325  0.004036918865472   12.347161701
0.001219232687076   0.001219232687076   0.001219232687076   0.7496986855957  0.001219232687076   0.3243835647418
0.0003837422984467  0.0003837422984467  0.0003837422984467  0.6926882608271  0.0003837422984467  0.1361719397498
0.0001070128410194  0.0001070128410194  0.0001070128410194  0.7643889137854  0.0001070128410194  0.07581952832542
0.0001001275033713  0.0001001275033714  0.0001001275033713  0.07058704838615 0.0001001275033713  0.07347394936346
4.550897507807e-05  4.550897507807e-05  4.550897507807e-05  0.576117248486   4.550897507807e-05  0.05555077655034
8.557124125834e-06  8.557124125853e-06  8.557124125835e-06  0.853592544106   8.557124125835e-06  0.0443981466023
3.611995628666e-06  3.611995628643e-06  3.611995628672e-06  0.6002277331398  3.611995628673e-06  0.0428300776216
7.590393750111e-07  7.590393750273e-07  7.590393750129e-07  0.8221486533655  7.590393750133e-07  0.04192322976247
8.299929287077e-08  8.299929283415e-08  8.299929287126e-08  0.901746793884   8.299929287181e-08  0.04170825633295
3.117560207452e-10  3.117560192413e-10  3.117560199213e-10  0.9970399692253  3.117560200234e-10  0.04168179329766
1.559774508975e-14  1.559825507727e-14  1.559755309294e-14  0.9999499686993  1.559748033629e-14  0.04168169240444
Optimization terminated successfully.
         Current function value: 0.041682
         Iterations: 13
Elapsed time : 2.0333712100982666 s
</pre></div>
</div>
</div>
<div class="section" id="dirac-data">
<h2>Dirac Data<a class="headerlink" href="#dirac-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">a1</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span>
<span class="n">a1</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">5</span>
<span class="n">a1</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="o">.</span><span class="mi">25</span>
<span class="n">a2</span><span class="p">[</span><span class="mi">80</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>


<span class="n">a1</span> <span class="o">/=</span> <span class="n">a1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">a2</span> <span class="o">/=</span> <span class="n">a2</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># creating matrix A containing all distributions</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">n_distributions</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># loss matrix + normalization</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">dist0</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">M</span> <span class="o">/=</span> <span class="n">M</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_distributions</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distributions&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_005.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_005.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># 0&lt;=alpha&lt;=1</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">alpha</span><span class="p">])</span>

<span class="c1"># l2bary</span>
<span class="n">bary_l2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="c1"># wasserstein</span>
<span class="n">reg</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">ot</span><span class="o">.</span><span class="n">tic</span><span class="p">()</span>
<span class="n">bary_wass</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">bregman</span><span class="o">.</span><span class="n">barycenter</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>


<span class="n">ot</span><span class="o">.</span><span class="n">tic</span><span class="p">()</span>
<span class="n">bary_wass2</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">lp</span><span class="o">.</span><span class="n">barycenter</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;interior-point&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ot</span><span class="o">.</span><span class="n">toc</span><span class="p">()</span>


<span class="n">problems</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="n">bary_l2</span><span class="p">,</span> <span class="n">bary_wass</span><span class="p">,</span> <span class="n">bary_wass2</span><span class="p">]])</span>

<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_distributions</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distributions&#39;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_l2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reg Wasserstein&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LP Wasserstein&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Barycenters&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_006.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_006.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Elapsed time : 0.001787424087524414 s
Primal Feasibility  Dual Feasibility    Duality Gap         Step             Path Parameter      Objective
1.0                 1.0                 1.0                 -                1.0                 1700.336700337
0.00677467552072    0.006774675520719   0.006774675520719   0.9932256422636  0.006774675520719   125.6956034741
0.002048208707556   0.002048208707555   0.002048208707555   0.734309536815   0.002048208707555   5.213991622102
0.0002697365474791  0.0002697365474791  0.0002697365474791  0.8839403501183  0.0002697365474791  0.5059383903908
6.832109993919e-05  6.832109993918e-05  6.832109993918e-05  0.7601171075982  6.832109993918e-05  0.2339657807271
2.437682932221e-05  2.437682932221e-05  2.437682932221e-05  0.6663448297463  2.437682932221e-05  0.1471256246325
1.134983216308e-05  1.134983216308e-05  1.134983216308e-05  0.5553643816417  1.134983216308e-05  0.1181584941171
3.342312725863e-06  3.34231272585e-06   3.342312725863e-06  0.7238133571629  3.342312725863e-06  0.1006387519746
7.078561231536e-07  7.078561231537e-07  7.078561231535e-07  0.803314255252   7.078561231535e-07  0.09474734646268
1.966870949422e-07  1.966870952674e-07  1.966870952717e-07  0.7525479180433  1.966870953014e-07  0.09354342735758
4.199895266495e-10  4.199895367352e-10  4.19989526535e-10   0.9984019849265  4.199895265747e-10  0.09310367785861
2.101053559204e-14  2.100331212975e-14  2.101054034304e-14  0.9999499736903  2.101053604307e-14  0.09310274466458
Optimization terminated successfully.
         Current function value: 0.093103
         Iterations: 11
Elapsed time : 2.1853578090667725 s
</pre></div>
</div>
</div>
<div class="section" id="final-figure">
<h2>Final figure<a class="headerlink" href="#final-figure" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nbm</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">problems</span><span class="p">)</span>
<span class="n">nbm2</span> <span class="o">=</span> <span class="p">(</span><span class="n">nbm</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>


<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">pl</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbm</span><span class="p">):</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">problems</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bary_l2</span> <span class="o">=</span> <span class="n">problems</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bary_wass</span> <span class="o">=</span> <span class="n">problems</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bary_wass2</span> <span class="o">=</span> <span class="n">problems</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nbm</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_distributions</span><span class="p">):</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">nbm2</span><span class="p">:</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distributions&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xticks</span><span class="p">(())</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">yticks</span><span class="p">(())</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">nbm</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="n">nbm</span><span class="p">)</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_l2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;L2 (Euclidean)&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reg Wasserstein&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">bary_wass2</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LP Wasserstein&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">nbm</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">nbm2</span><span class="p">:</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Barycenters&#39;</span><span class="p">)</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">xticks</span><span class="p">(())</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">yticks</span><span class="p">(())</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_007.png" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_barycenter_lp_vs_entropic_007.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  7.697 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-barycenter-lp-vs-entropic-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2b509166ddcfc97c0b6785ff13ef9e3d/plot_barycenter_lp_vs_entropic.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_barycenter_lp_vs_entropic.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/01418a06524745511427c79b929f90bb/plot_barycenter_lp_vs_entropic.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_barycenter_lp_vs_entropic.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_barycenter_fgw.html" class="btn btn-neutral float-right" title="Plot graphs’ barycenter using FGW" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_otda_jcpot.html" class="btn btn-neutral float-left" title="OT for multi-source target shift" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2019, Rémi Flamary, Nicolas Courty

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>